{% extends "base.html" %}
{% load static %}

{% block title %}My Watchlist | MovieMeter{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'movies/home.css' %}">
<link rel="stylesheet" href="{% static 'movies/watchlist.css' %}">
{% endblock %}
{% block navbar %}
  {% include "includes/navbar.html" with mode="mini" %}
{% endblock %}

{% block content %}

<div class="watchlist-page">

 
  <div class="watchlist-header">
    <div class="watchlist-title">
      <h1>My Watchlist</h1>
      <p>{{ watchlist_count }} movies saved</p>
    </div>

    <div class="watchlist-actions">
      <a href="{% url 'movies-home' %}" class="browse-btn">Browse Movies</a>
    </div>
  </div>

  {% if watchlist_movies %}
  <section class="movie-grid">
  {% for item in watchlist_movies %}
    {% with movie=item.movie %}
    <a href="{% url 'movie-detail' movie.id %}" class="movie-card-link">
      <div class="movie-card">

        <div class="poster-container">
          {% if movie.poster_path %}
            <img src="https://image.tmdb.org/t/p/w500{{ movie.poster_path }}"
                 alt="{{ movie.title }}"
                 loading="lazy">
          {% else %}
            <div class="no-poster"><span>ðŸŽ¬</span></div>
          {% endif %}

          <div class="card-overlay">
            <span class="view-btn">View Details</span>
          </div>

          {% if item.total_hype_votes > 0 %}
          <div class="hype-badge">
            Hype: {{ item.excited_count }}/{{ item.total_hype_votes }}
          </div>
          {% endif %}
        </div>

        <div class="card-info">
          <span class="status-badge {% if movie.is_released %}released{% else %}upcoming{% endif %}">
            {% if movie.is_released %}Released{% else %}Upcoming{% endif %}
          </span>

          <h3 class="movie-title">{{ movie.title }}</h3>

          <div class="movie-genres">
            {% for g in movie.categories.all|slice:":2" %}
              <span class="genre-tag">{{ g.name }}</span>
            {% endfor %}
          </div>

          <p class="release-date">
            {% if movie.release_date %}
              {{ movie.release_date|date:"d M Y" }}
            {% endif %}
          </p>
        </div>

      </div>
    </a>
    {% endwith %}
  {% endfor %}
</section>

  {% else %}
  <div class="empty-watchlist">
    <div class="empty-icon">ðŸŽ¬</div>
    <h2>Your Watchlist is empty</h2>
    <p>Save movies here and come back anytime.</p>
    <a href="{% url 'movies-home' %}" class="browse-btn big">Browse Movies</a>
  </div>
  {% endif %}

</div>

{% endblock %}
